<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Comunidad Powerlifting - Preguntas y debates</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAHwg5fSQNvDzhxOeRiOXUqKb2Y52JTxFs",
      authDomain: "sergiopowercoach-foro.firebaseapp.com",
      projectId: "sergiopowercoach-foro",
      storageBucket: "sergiopowercoach-foro.appspot.com",
      messagingSenderId: "571520460029",
      appId: "1:571520460029:web:2c942e15addfe92d164a94",
      measurementId: "G-18K2P3CEZS"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
  </script>
  
</head>
<body class="bg-gray-50 text-gray-900 font-sans min-h-screen flex flex-col">

  <!-- HEADER SIMPLE -->
  <header class="bg-blue-600 text-white p-4 sticky top-0 shadow-md z-20">
    <div class="container mx-auto flex justify-between items-center">
      <h1 class="text-xl font-bold">Comunidad Powerlifting</h1>
      <nav class="space-x-4">
        <a href="index.html" class="hover:underline">Inicio</a>
        <a href="blog.html" class="hover:underline">Blog</a>
        <a href="comunidad.html" class="underline font-semibold">Comunidad</a>
      </nav>
    </div>
  </header>

  <main class="container mx-auto flex-grow px-4 py-8 max-w-4xl">

    <!-- NUEVA PREGUNTA -->
    <section class="mb-12 bg-white rounded-lg shadow p-6">
      <h2 class="text-2xl font-bold mb-4">Plantea tu duda o tema</h2>
      <form id="new-post-form" class="space-y-4">
        <input
          type="text"
          id="author"
          placeholder="Tu nombre o nick"
          class="w-full p-3 border border-gray-300 rounded"
          required
        />
        <textarea
          id="content"
          rows="4"
          placeholder="Describe tu duda, experiencia o tema para debate..."
          class="w-full p-3 border border-gray-300 rounded resize-y"
          required
        ></textarea>
        <button
          type="submit"
          class="bg-blue-600 text-white px-6 py-3 rounded hover:bg-blue-700 transition"
        >
          Publicar pregunta
        </button>
      </form>
      <p class="mt-2 text-sm text-gray-500 italic">* Esta es una demo. Las preguntas se guardan en localStorage.</p>
    </section>

    <!-- LISTADO DE PREGUNTAS -->
    <section id="posts-list" class="space-y-8">

      <!-- Aquí se cargarán las preguntas dinámicamente -->

    </section>
  </main>

  <!-- FOOTER -->
  <footer class="bg-blue-600 text-white p-6 text-center mt-12">
    <p>&copy; 2025 TuNombreFit | Comunidad Powerlifting</p>
  </footer>

  <script>
    // Función para cargar preguntas del localStorage y mostrarlas
    function cargarPreguntas() {
      const postsList = document.getElementById('posts-list');
      postsList.innerHTML = '';

      let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];

      preguntas.forEach((pregunta, idx) => {
        const article = document.createElement('article');
        article.className = 'bg-white rounded-lg shadow p-6';

        article.innerHTML = `
          <header class="mb-4 flex justify-between items-center">
            <h3 class="text-xl font-semibold">${pregunta.titulo}</h3>
            <span class="text-sm text-gray-500">por <strong>${pregunta.autor}</strong></span>
          </header>
          <p class="mb-4 text-gray-700">${pregunta.contenido}</p>
          <div class="space-y-4 border-t border-gray-200 pt-4" id="respuestas-${idx}">
            ${pregunta.respuestas ? pregunta.respuestas.map(resp => `
              <div class="bg-gray-100 rounded p-3">
                <p><strong>${resp.autor}:</strong> ${resp.texto}</p>
              </div>
            `).join('') : ''}
            <form class="mt-4 space-y-2 respuesta-form" data-index="${idx}">
              <input type="text" placeholder="Tu nombre o nick" class="w-full p-2 border border-gray-300 rounded" required />
              <textarea rows="2" placeholder="Escribe tu respuesta..." class="w-full p-2 border border-gray-300 rounded resize-y" required></textarea>
              <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Responder</button>
            </form>
          </div>
        `;

        postsList.appendChild(article);
      });

      // Añadir event listeners a los formularios de respuesta
      document.querySelectorAll('.respuesta-form').forEach(form => {
        form.addEventListener('submit', function(e) {
          e.preventDefault();
          const idx = this.dataset.index;
          const nombre = this.querySelector('input').value.trim();
          const texto = this.querySelector('textarea').value.trim();
          if (!nombre || !texto) {
            alert('Por favor completa ambos campos para responder.');
            return;
          }

          let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];
          if (!preguntas[idx].respuestas) {
            preguntas[idx].respuestas = [];
          }
          preguntas[idx].respuestas.push({ autor: nombre, texto: texto });
          localStorage.setItem('preguntas', JSON.stringify(preguntas));

          cargarPreguntas();
        });
      });
    }

    // Cargar preguntas al iniciar
    cargarPreguntas();

    // Manejar formulario de nueva pregunta
    document.getElementById('new-post-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const autor = this.querySelector('#author').value.trim();
      const contenido = this.querySelector('#content').value.trim();
      if (!autor || !contenido) {
        alert('Por favor completa todos los campos.');
        return;
      }

      let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];
      preguntas.unshift({
        titulo: contenido.length > 50 ? contenido.substring(0, 50) + '...' : contenido,
        autor: autor,
        contenido: contenido,
        respuestas: []
      });
      localStorage.setItem('preguntas', JSON.stringify(preguntas));

      this.reset();
      cargarPreguntas();
    });
  </script>
</body>
</html>
