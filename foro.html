<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Comunidad Powerlifting - Preguntas y debates</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAHwg5fSQNvDzhxOeRiOXUqKb2Y52JTxFs",
      authDomain: "sergiopowercoach-foro.firebaseapp.com",
      projectId: "sergiopowercoach-foro",
      storageBucket: "sergiopowercoach-foro.appspot.com",
      messagingSenderId: "571520460029",
      appId: "1:571520460029:web:2c942e15addfe92d164a94",
      measurementId: "G-18K2P3CEZS"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
  </script>
  
</head>
<body class="bg-gray-50 text-gray-900 font-sans min-h-screen flex flex-col">

  <!-- HEADER SIMPLE -->
  <header class="bg-blue-600 text-white p-4 sticky top-0 shadow-md z-20">
    <div class="container mx-auto flex justify-between items-center">
      <h1 class="text-xl font-bold">Comunidad Powerlifting</h1>
      <nav class="space-x-4">
        <a href="index.html" class="hover:underline">Inicio</a>
        <a href="blog.html" class="hover:underline">Blog</a>
        <a href="comunidad.html" class="underline font-semibold">Comunidad</a>
      </nav>
    </div>
  </header>

  <main class="container mx-auto flex-grow px-4 py-8 max-w-4xl">

    <!-- NUEVA PREGUNTA -->
    <section class="mb-12 bg-white rounded-lg shadow p-6">
      <h2 class="text-2xl font-bold mb-4">Plantea tu duda o tema</h2>
      <form id="new-post-form" class="space-y-4">
        <input
          type="text"
          id="author"
          placeholder="Tu nombre o nick"
          class="w-full p-3 border border-gray-300 rounded"
          required
        />
        <textarea
          id="content"
          rows="4"
          placeholder="Describe tu duda, experiencia o tema para debate..."
          class="w-full p-3 border border-gray-300 rounded resize-y"
          required
        ></textarea>
        <button
          type="submit"
          class="bg-blue-600 text-white px-6 py-3 rounded hover:bg-blue-700 transition"
        >
          Publicar pregunta
        </button>
      </form>
      <!-- P√ÅRRAFO DEL TEXTO DEMO ELIMINADO AQU√ç -->
    </section>

    <!-- FILTRO VISUAL -->
    <section class="mb-8 bg-white rounded-lg shadow p-4 flex items-center space-x-4">
      <label for="filtro" class="font-semibold">Ordenar por:</label>
      <select id="filtro" class="border border-gray-300 rounded p-2">
        <option value="mas_recientes">M√°s recientes</option>
        <option value="mas_antiguas">M√°s antiguas</option>
      </select>
    </section>

    <!-- LISTADO DE PREGUNTAS -->
    <section id="posts-list" class="space-y-8">

      <!-- Pregunta 1 -->
      <article class="bg-white rounded-lg shadow p-6">
        <header class="mb-4 flex justify-between items-center">
          <h3 class="text-xl font-semibold">¬øCu√°l es la mejor t√©cnica para mejorar la sentadilla?</h3>
          <span class="text-sm text-gray-500">por <strong>AnaFit</strong></span>
        </header>
        <p class="mb-4 text-gray-700">
          He estado entrenando sentadillas pero siento que no progreso. ¬øQu√© consejos o t√©cnicas me recomiendan para mejorar la forma y fuerza?
        </p>
        <div class="space-y-4 border-t border-gray-200 pt-4">

          <!-- Respuesta -->
          <div class="bg-gray-100 rounded p-3">
            <p><strong>EntrenadorPro:</strong> Enf√≥cate en mantener el core activado y la barra estable. Tambi√©n, trabaja movilidad de cadera y tobillos.</p>
          </div>
          <div class="bg-gray-100 rounded p-3">
            <p><strong>FitLover:</strong> A√±ade trabajo de sentadillas frontales y sentadillas con pausa para ganar control.</p>
          </div>

          <!-- Formulario de respuesta -->
          <form class="mt-4 space-y-2">
            <textarea
              rows="2"
              placeholder="Escribe tu respuesta..."
              class="w-full p-2 border border-gray-300 rounded resize-y"
              required
            ></textarea>
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"
            >
              Responder
            </button>
          </form>
        </div>
      </article>

      <!-- Pregunta 2 -->
      <article class="bg-white rounded-lg shadow p-6">
        <header class="mb-4 flex justify-between items-center">
          <h3 class="text-xl font-semibold">¬øQu√© suplementos ayudan a mejorar la recuperaci√≥n?</h3>
          <span class="text-sm text-gray-500">por <strong>CarlosP</strong></span>
        </header>
        <p class="mb-4 text-gray-700">
          Despu√©s de entrenar muy duro me cuesta recuperarme, ¬øqu√© suplementos me recomiendan para acelerar la recuperaci√≥n muscular?
        </p>
        <div class="space-y-4 border-t border-gray-200 pt-4">

          <!-- Respuesta -->
          <div class="bg-gray-100 rounded p-3">
            <p><strong>NutriCoach:</strong> Prote√≠na de suero, BCAA y creatina son buenos para recuperaci√≥n y s√≠ntesis muscular.</p>
          </div>

          <!-- Formulario de respuesta -->
          <form class="mt-4 space-y-2">
            <textarea
              rows="2"
              placeholder="Escribe tu respuesta..."
              class="w-full p-2 border border-gray-300 rounded resize-y"
              required
            ></textarea>
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"
            >
              Responder
            </button>
          </form>
        </div>
      </article>

    </section>
  </main>

  <!-- FOOTER -->
  <footer class="bg-blue-600 text-white p-6 text-center mt-12">
    <p>&copy; 2025 TuNombreFit | Comunidad Powerlifting</p>
  </footer>

  <script>
    // Demo: prevenir recarga y mostrar alert al enviar nueva pregunta
    document.getElementById('new-post-form').addEventListener('submit', function(e) {
      e.preventDefault();
      alert('Gracias por tu pregunta. En esta demo a√∫n no se guarda.');
      this.reset();
    });

    // Aqu√≠ puedes agregar funcionalidad para responder preguntas m√°s adelante
  </script>

  <!-- --- C√ìDIGO NUEVO A√ëADIDO PARA GUARDAR, RESPONDER, BORRAR Y FILTRAR --- -->
  <script>
  const defaultPreguntas = [
    {
      autor: "AnaFit",
      contenido: "He estado entrenando sentadillas pero siento que no progreso. ¬øQu√© consejos o t√©cnicas me recomiendan para mejorar la forma y fuerza?",
      titulo: "¬øCu√°l es la mejor t√©cnica para mejorar la sentadilla?",
      fecha: Date.now() - 100000,
      respuestas: [
        { autor: "EntrenadorPro", texto: "Enf√≥cate en mantener el core activado y la barra estable.", likes: 0 },
        { autor: "FitLover", texto: "A√±ade trabajo de sentadillas frontales y sentadillas con pausa.", likes: 0 }
      ]
    },
    {
      autor: "CarlosP",
      contenido: "Despu√©s de entrenar muy duro me cuesta recuperarme, ¬øqu√© suplementos me recomiendan para acelerar la recuperaci√≥n muscular?",
      titulo: "¬øQu√© suplementos ayudan a mejorar la recuperaci√≥n?",
      fecha: Date.now() - 50000,
      respuestas: [
        { autor: "NutriCoach", texto: "Prote√≠na de suero, BCAA y creatina son buenos para recuperaci√≥n.", likes: 0 }
      ]
    }
  ];

  function cargarPreguntas(filtro = 'mas_recientes') {
    const postsList = document.getElementById('posts-list');
    postsList.innerHTML = '';

    let preguntas = JSON.parse(localStorage.getItem('preguntas'));

    if (!preguntas) {
      preguntas = [];  // <-- Aqu√≠ cambio importante para que no reemplace con defaultPreguntas
    }

    if (filtro === 'mas_recientes') {
      preguntas.sort((a, b) => b.fecha - a.fecha);
    } else {
      preguntas.sort((a, b) => a.fecha - b.fecha);
    }

    preguntas.forEach((pregunta, idx) => {
      const article = document.createElement('article');
      article.className = 'bg-white rounded-lg shadow p-6';

      article.innerHTML = `
        <header class="mb-4 flex justify-between items-center">
          <h3 class="text-xl font-semibold">${pregunta.titulo}</h3>
          <span class="text-sm text-gray-500">por <strong>${pregunta.autor}</strong></span>
          <button data-index="${idx}" class="btn-borrar-pregunta ml-4 text-red-600 hover:text-red-800 font-semibold">[Borrar Pregunta]</button>
        </header>
        <p class="mb-4 text-gray-700">${pregunta.contenido}</p>
        <div class="space-y-4 border-t border-gray-200 pt-4" id="respuestas-${idx}">
          ${(pregunta.respuestas || []).map((resp, ridx) => `
            <div class="bg-gray-100 rounded p-3 flex justify-between items-start gap-4">
              <div>
                <p><strong>${resp.autor}:</strong> ${resp.texto}</p>
                <button class="like-btn text-blue-600 text-sm mt-1" data-pregunta="${idx}" data-respuesta="${ridx}">
                  üëç Me gusta (<span class="like-count">${resp.likes || 0}</span>)
                </button>
              </div>
              <button data-pregunta="${idx}" data-respuesta="${ridx}" class="btn-borrar-respuesta text-red-600 hover:text-red-800 font-semibold ml-4">[X]</button>
            </div>
          `).join('')}
          <form class="mt-4 space-y-2 respuesta-form" data-index="${idx}">
            <input type="text" placeholder="Tu nombre o nick" class="w-full p-2 border border-gray-300 rounded" required />
            <textarea rows="2" placeholder="Escribe tu respuesta..." class="w-full p-2 border border-gray-300 rounded resize-y" required></textarea>
            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Responder</button>
          </form>
        </div>
      `;

      postsList.appendChild(article);
    });

    // A√±adir event listeners para borrar pregunta
    document.querySelectorAll('.btn-borrar-pregunta').forEach(btn => {
      btn.addEventListener('click', () => {
        const idx = parseInt(btn.getAttribute('data-index'));
        borrarPregunta(idx);
      });
    });

    // Event listeners para formularios de respuesta
    document.querySelectorAll('.respuesta-form').forEach(form => {
      form.addEventListener('submit', e => {
        e.preventDefault();
        const idx = parseInt(form.getAttribute('data-index'));
        const autorInput = form.querySelector('input');
        const textoInput = form.querySelector('textarea');
        if (!autorInput.value.trim() || !textoInput.value.trim()) return;
        agregarRespuesta(idx, autorInput.value.trim(), textoInput.value.trim());
        autorInput.value = '';
        textoInput.value = '';
      });
    });

    // Event listeners para likes
    document.querySelectorAll('.like-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const pidx = parseInt(btn.getAttribute('data-pregunta'));
        const ridx = parseInt(btn.getAttribute('data-respuesta'));
        agregarLike(pidx, ridx);
      });
    });

    // Event listeners para borrar respuesta
    document.querySelectorAll('.btn-borrar-respuesta').forEach(btn => {
      btn.addEventListener('click', () => {
        const pidx = parseInt(btn.getAttribute('data-pregunta'));
        const ridx = parseInt(btn.getAttribute('data-respuesta'));
        borrarRespuesta(pidx, ridx);
      });
    });
  }

  function guardarPreguntas(preguntas) {
    localStorage.setItem('preguntas', JSON.stringify(preguntas));
  }

  function agregarPregunta(autor, contenido) {
    let preguntas = JSON.parse(localStorage.getItem('preguntas'));
    if (!preguntas) {
      preguntas = [];
    }

    const titulo = contenido.split('.')[0] || contenido; // Simple para t√≠tulo

    preguntas.push({
      autor,
      contenido,
      titulo,
      fecha: Date.now(),
      respuestas: []
    });

    guardarPreguntas(preguntas);
    cargarPreguntas(document.getElementById('filtro').value);
  }

  function borrarPregunta(idx) {
    let preguntas = JSON.parse(localStorage.getItem('preguntas'));
    if (!preguntas) return;
    preguntas.splice(idx, 1);
    guardarPreguntas(preguntas);
    cargarPreguntas(document.getElementById('filtro').value);
  }

  function agregarRespuesta(pidx, autor, texto) {
    let preguntas = JSON.parse(localStorage.getItem('preguntas'));
    if (!preguntas) return;
    if (!preguntas[pidx]) return;
    if (!preguntas[pidx].respuestas) preguntas[pidx].respuestas = [];
    preguntas[pidx].respuestas.push({ autor, texto, likes: 0 });
    guardarPreguntas(preguntas);
    cargarPreguntas(document.getElementById('filtro').value);
  }

  function borrarRespuesta(pidx, ridx) {
    let preguntas = JSON.parse(localStorage.getItem('preguntas'));
    if (!preguntas) return;
    if (!preguntas[pidx] || !preguntas[pidx].respuestas) return;
    preguntas[pidx].respuestas.splice(ridx, 1);
    guardarPreguntas(preguntas);
    cargarPreguntas(document.getElementById('filtro').value);
  }

  function agregarLike(pidx, ridx) {
    let preguntas = JSON.parse(localStorage.getItem('preguntas'));
    if (!preguntas) return;
    if (!preguntas[pidx] || !preguntas[pidx].respuestas) return;
    preguntas[pidx].respuestas[ridx].likes = (preguntas[pidx].respuestas[ridx].likes || 0) + 1;
    guardarPreguntas(preguntas);
    cargarPreguntas(document.getElementById('filtro').value);
  }

  // Evento para enviar nueva pregunta
  document.getElementById('new-post-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const autor = document.getElementById('author').value.trim();
    const contenido = document.getElementById('content').value.trim();
    if (!autor || !contenido) return alert('Por favor completa todos los campos.');
    agregarPregunta(autor, contenido);
    this.reset();
  });

  // Evento para filtro orden
  document.getElementById('filtro').addEventListener('change', function() {
    cargarPreguntas(this.value);
  });

  // Cargar preguntas al inicio
  cargarPreguntas();
  </script>
</body>
</html>

