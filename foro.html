<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Comunidad Powerlifting - Preguntas y debates</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAHwg5fSQNvDzhxOeRiOXUqKb2Y52JTxFs",
      authDomain: "sergiopowercoach-foro.firebaseapp.com",
      projectId: "sergiopowercoach-foro",
      storageBucket: "sergiopowercoach-foro.appspot.com",
      messagingSenderId: "571520460029",
      appId: "1:571520460029:web:2c942e15addfe92d164a94",
      measurementId: "G-18K2P3CEZS"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
  </script>
  
</head>
<body class="bg-gray-50 text-gray-900 font-sans min-h-screen flex flex-col">

  <!-- HEADER SIMPLE -->
  <header class="bg-blue-600 text-white p-4 sticky top-0 shadow-md z-20">
    <div class="container mx-auto flex justify-between items-center">
      <h1 class="text-xl font-bold">Comunidad Powerlifting</h1>
      <nav class="space-x-4">
        <a href="index.html" class="hover:underline">Inicio</a>
        <a href="blog.html" class="hover:underline">Blog</a>
        <a href="comunidad.html" class="underline font-semibold">Comunidad</a>
      </nav>
    </div>
  </header>

  <main class="container mx-auto flex-grow px-4 py-8 max-w-4xl">

    <!-- NUEVA PREGUNTA -->
    <section class="mb-12 bg-white rounded-lg shadow p-6">
      <h2 class="text-2xl font-bold mb-4">Plantea tu duda o tema</h2>
      <form id="new-post-form" class="space-y-4">
  <input
    type="text"
    id="author"
    placeholder="Tu nombre o nick"
    class="w-full p-3 border border-gray-300 rounded"
    required
  />
  <input
    type="text"
    id="title"
    placeholder="Título de tu pregunta"
    class="w-full p-3 border border-gray-300 rounded"
    required
  />
  <textarea
    id="content"
    rows="4"
    placeholder="Describe tu duda, experiencia o tema para debate..."
    class="w-full p-3 border border-gray-300 rounded resize-y"
    required
  ></textarea>
  <button
    type="submit"
    class="bg-blue-600 text-white px-6 py-3 rounded hover:bg-blue-700 transition"
  >
    Publicar pregunta
  </button>
</form>
      <!-- Nota: Este párrafo se mantiene porque pediste NO eliminar ninguna línea -->
    </section>

    <!-- FILTRO VISUAL -->
    <section class="mb-8 bg-white rounded-lg shadow p-4 flex items-center space-x-4">
      <label for="filtro" class="font-semibold">Ordenar por:</label>
      <select id="filtro" class="border border-gray-300 rounded p-2">
        <option value="mas_recientes">Más recientes</option>
        <option value="mas_antiguas">Más antiguas</option>
      </select>
    </section>

    <!-- LISTADO DE PREGUNTAS -->
    <section id="posts-list" class="space-y-8">

      <!-- Pregunta 1 -->
      <article class="bg-white rounded-lg shadow p-6">
        <header class="mb-4 flex justify-between items-center">
          <h3 class="text-xl font-semibold">¿Cuál es la mejor técnica para mejorar la sentadilla?</h3>
          <span class="text-sm text-gray-500">por <strong>AnaFit</strong></span>
        </header>
        <p class="mb-4 text-gray-700">
          He estado entrenando sentadillas pero siento que no progreso. ¿Qué consejos o técnicas me recomiendan para mejorar la forma y fuerza?
        </p>
        <div class="space-y-4 border-t border-gray-200 pt-4">

          <!-- Respuesta -->
          <div class="bg-gray-100 rounded p-3">
            <p><strong>EntrenadorPro:</strong> Enfócate en mantener el core activado y la barra estable. También, trabaja movilidad de cadera y tobillos.</p>
          </div>
          <div class="bg-gray-100 rounded p-3">
            <p><strong>FitLover:</strong> Añade trabajo de sentadillas frontales y sentadillas con pausa para ganar control.</p>
          </div>

          <!-- Formulario de respuesta -->
          <form class="mt-4 space-y-2">
            <textarea
              rows="2"
              placeholder="Escribe tu respuesta..."
              class="w-full p-2 border border-gray-300 rounded resize-y"
              required
            ></textarea>
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"
            >
              Responder
            </button>
          </form>
        </div>
      </article>

      <!-- Pregunta 2 -->
      <article class="bg-white rounded-lg shadow p-6">
        <header class="mb-4 flex justify-between items-center">
          <h3 class="text-xl font-semibold">¿Qué suplementos ayudan a mejorar la recuperación?</h3>
          <span class="text-sm text-gray-500">por <strong>CarlosP</strong></span>
        </header>
        <p class="mb-4 text-gray-700">
          Después de entrenar muy duro me cuesta recuperarme, ¿qué suplementos me recomiendan para acelerar la recuperación muscular?
        </p>
        <div class="space-y-4 border-t border-gray-200 pt-4">

          <!-- Respuesta -->
          <div class="bg-gray-100 rounded p-3">
            <p><strong>NutriCoach:</strong> Proteína de suero, BCAA y creatina son buenos para recuperación y síntesis muscular.</p>
          </div>

          <!-- Formulario de respuesta -->
          <form class="mt-4 space-y-2">
            <textarea
              rows="2"
              placeholder="Escribe tu respuesta..."
              class="w-full p-2 border border-gray-300 rounded resize-y"
              required
            ></textarea>
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"
            >
              Responder
            </button>
          </form>
        </div>
      </article>

    </section>
  </main>

  <!-- FOOTER -->
  <footer class="bg-blue-600 text-white p-6 text-center mt-12">
    <p>&copy; 2025 SergioPowerCoach | Comunidad Powerlifting</p>
  </footer>

  <script>

    // Aquí puedes agregar funcionalidad para responder preguntas más adelante
  </script>

  <!-- --- CÓDIGO NUEVO AÑADIDO PARA GUARDAR, RESPONDER, BORRAR Y FILTRAR --- -->
 <script>
function cargarPreguntas(filtro = 'mas_recientes') {
  const postsList = document.getElementById('posts-list');
  postsList.innerHTML = '';

  let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];

  // Ordenar según filtro
  if (filtro === 'mas_recientes') {
    preguntas.sort((a, b) => b.fecha - a.fecha);
  } else {
    preguntas.sort((a, b) => a.fecha - b.fecha);
  }

  preguntas.forEach((pregunta, idx) => {
    const respuestas = pregunta.respuestas || [];

    const article = document.createElement('article');
    article.className = 'bg-white rounded-lg shadow p-6';
    article.innerHTML = `
      <header class="mb-4 flex justify-between items-center">
        <h3 class="text-xl font-semibold">${pregunta.titulo}</h3>
        <span class="text-sm text-gray-500">por <strong>${pregunta.autor}</strong></span>
      </header>
      <p class="mb-4 text-gray-700">${pregunta.contenido || ''}</p>
      <div class="flex items-center gap-4 text-sm mb-4">
        <button class="btn-like-pregunta text-blue-600 hover:underline" data-index="${idx}">👍 Me gusta (${pregunta.likes || 0})</button>
        <span class="text-gray-600">💬 ${respuestas.length} respuestas</span>
        <button class="btn-borrar-pregunta text-red-500 hover:underline" data-index="${idx}">🗑 Borrar</button>
      </div>
      <div class="space-y-4 border-t border-gray-200 pt-4">
        ${respuestas.map((respuesta, ridx) => `
          <div class="bg-gray-100 rounded p-3">
            <p><strong>${respuesta.autor}:</strong> ${respuesta.texto}</p>
            <div class="flex items-center gap-3 text-sm mt-2">
              <button class="btn-like-respuesta text-blue-600 hover:underline" data-pregunta="${idx}" data-respuesta="${ridx}">👍 Me gusta (${respuesta.likes || 0})</button>
              <button class="btn-borrar-respuesta text-red-500 hover:underline" data-pregunta="${idx}" data-respuesta="${ridx}">🗑 Borrar</button>
            </div>
          </div>
        `).join('')}
        <form class="respuesta-form mt-4 space-y-2" data-index="${idx}">
          <input type="text" placeholder="Tu nombre o nick" class="w-full p-2 border border-gray-300 rounded" required>
          <textarea rows="2" placeholder="Escribe tu respuesta..." class="w-full p-2 border border-gray-300 rounded resize-y" required></textarea>
          <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Responder</button>
        </form>
      </div>
    `;
    postsList.appendChild(article);
  });
}

// Event listener global (click)
document.addEventListener('click', e => {
  if (e.target.classList.contains('btn-like-pregunta')) {
    const idx = Number(e.target.getAttribute('data-index'));
    let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];
    if (preguntas[idx]) {
      preguntas[idx].likes = (preguntas[idx].likes || 0) + 1;
      localStorage.setItem('preguntas', JSON.stringify(preguntas));
      cargarPreguntas(document.getElementById('filtro').value);
    }
  }

  if (e.target.classList.contains('btn-borrar-pregunta')) {
    const idx = Number(e.target.getAttribute('data-index'));
    let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];
    if (preguntas[idx]) {
      preguntas.splice(idx, 1);
      localStorage.setItem('preguntas', JSON.stringify(preguntas));
      cargarPreguntas(document.getElementById('filtro').value);
    }
  }

  if (e.target.classList.contains('btn-like-respuesta')) {
    const pIdx = Number(e.target.getAttribute('data-pregunta'));
    const rIdx = Number(e.target.getAttribute('data-respuesta'));
    let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];
    if (preguntas[pIdx] && preguntas[pIdx].respuestas && preguntas[pIdx].respuestas[rIdx]) {
      preguntas[pIdx].respuestas[rIdx].likes = (preguntas[pIdx].respuestas[rIdx].likes || 0) + 1;
      localStorage.setItem('preguntas', JSON.stringify(preguntas));
      cargarPreguntas(document.getElementById('filtro').value);
    }
  }

  if (e.target.classList.contains('btn-borrar-respuesta')) {
    const pIdx = Number(e.target.getAttribute('data-pregunta'));
    const rIdx = Number(e.target.getAttribute('data-respuesta'));
    let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];
    if (preguntas[pIdx] && preguntas[pIdx].respuestas && preguntas[pIdx].respuestas[rIdx]) {
      preguntas[pIdx].respuestas.splice(rIdx, 1);
      localStorage.setItem('preguntas', JSON.stringify(preguntas));
      cargarPreguntas(document.getElementById('filtro').value);
    }
  }
});

// Event listener para agregar nueva pregunta
document.getElementById('new-post-form').addEventListener('submit', e => {
  e.preventDefault();
  const autor = document.getElementById('author').value.trim();
  const contenido = document.getElementById('content').value.trim();

  if (!autor || !contenido) return;

  let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];

  preguntas.push({
    titulo: contenido, // O si tienes campo titulo separado, usarlo aquí
    autor: autor,
    fecha: Date.now(),
    respuestas: [],
    likes: 0
  });

  localStorage.setItem('preguntas', JSON.stringify(preguntas));

  e.target.reset();

  cargarPreguntas(document.getElementById('filtro').value);
});

// Event listener para respuestas
document.addEventListener('submit', e => {
  if (e.target.classList.contains('respuesta-form')) {
    e.preventDefault();
    const idx = Number(e.target.getAttribute('data-index'));
    const inputs = e.target.querySelectorAll('input, textarea');
    const autor = inputs[0].value.trim();
    const texto = inputs[1].value.trim();

    if (!autor || !texto) return;

    let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];
    if (!preguntas[idx].respuestas) preguntas[idx].respuestas = [];

    preguntas[idx].respuestas.push({ autor, texto, likes: 0 });
    localStorage.setItem('preguntas', JSON.stringify(preguntas));

    cargarPreguntas(document.getElementById('filtro').value);
  }
});

  // Nuevo post
  document.getElementById('new-post-form').addEventListener('submit', e => {
  e.preventDefault();

  const autor = document.getElementById('author').value.trim();
  const titulo = document.getElementById('title').value.trim();
  const contenido = document.getElementById('content').value.trim();

  // Validar que autor, título y contenido estén completos
  if (!autor || !titulo || !contenido) return;

  let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];

  preguntas.push({
    titulo: titulo,       // Guardamos título separado
    contenido: contenido, // Guardamos contenido separado
    autor: autor,
    fecha: Date.now(),
    respuestas: [],
    likes: 0
  });

  localStorage.setItem('preguntas', JSON.stringify(preguntas));

  // Limpiar form
  e.target.reset();

  // Recargar lista con filtro actual
  cargarPreguntas(document.getElementById('filtro').value);
});

  // Envío de respuestas (delegado, porque son dinámicos)
  document.addEventListener('submit', e => {
    if (e.target.classList.contains('respuesta-form')) {
      e.preventDefault();
      const idx = e.target.getAttribute('data-index');
      const inputs = e.target.querySelectorAll('input, textarea');
      const autor = inputs[0].value.trim();
      const texto = inputs[1].value.trim();

      if (!autor || !texto) return;

      let preguntas = JSON.parse(localStorage.getItem('preguntas')) || [];
      if (!preguntas[idx].respuestas) preguntas[idx].respuestas = [];

      preguntas[idx].respuestas.push({ autor, texto, likes: 0 });
      localStorage.setItem('preguntas', JSON.stringify(preguntas));

      cargarPreguntas(document.getElementById('filtro').value);
    }
  });

  // Cambio de filtro
  document.getElementById('filtro').addEventListener('change', e => {
    cargarPreguntas(e.target.value);
  });

  // Carga inicial
  cargarPreguntas();
</script>

</body>
</html>
